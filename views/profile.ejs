<% include ./partials/header.ejs %>
    <div class="w-full  min-h-full bg-zinc-900 text-white py-5">
        <div class="upper">
            <div class="nav flex justify-between items-center px-4">
                <h3 class="text-lg">
                    <%= loginuser.username %>
                </h3>
                <div class="icons flex gap-5">
                    <a href="/upload"><i class="text-[1.4rem] ri-add-box-line"></i></a>
                    <i class="text-[1.4rem] ri-menu-line"></i>
                </div>
            </div>
            <div class="flex justify-between items-center pl-6 pr-[12vw] mt-8">

                <% if(loginuser.stories.length > 0){  %>
                    <a class="cursor-pointer" href="/story/<%= loginuser._id %>/0">
                        <div class="w-[19vw] h-[19vw] bg-sky-100 gradient bg-sky-100 overflow-hidden rounded-full bg-gradient-to-r from-purple-700 to-orange-500 flex items-center justify-center ">
                            <div class="inner w-[92%] h-[92%] rounded-full overflow-hidden">
                                <img class="w-full h-full object-center object-cover rounded-full " src="/images/uploads/<%= loginuser.profile %> " alt="">
                            </div>
                        </div>
                    </a>
                    <%   }  else { %>
                        <div class="w-[19vw] h-[19vw]  overflow-hidden ">
                            <div class="inner w-[99%] h-[99%] rounded-full overflow-hidden">
                                <img class="w-full h-full object-center object-cover rounded-full " src="/images/uploads/<%= loginuser.profile %> " alt="">
                            </div>
                        </div>
                        <%  } %>


                            <div class="stats flex gap-5 items-center justify-between">
                                <div class="flex flex-col items-center justify-center">
                                    <h3 class="cursor-pointer">
                                        <%= loginuser.posts.length %>
                                    </h3>
                                    <h4 class="cursor-pointer postbtn ">Posts</h4>
                                </div>
                                <a href="/myfollowers">
                                    <div class="flex flex-col items-center justify-center cursor-pointer">
                                        <h3>
                                            <%= loginuser.followers.length %>
                                        </h3>
                                        <h4>Followers</h4>
                                    </div>
                                </a>

                                <a href="/myfollowing">
                                    <div class="flex flex-col items-center justify-center cursor-pointer">
                                        <h3>
                                            <%= loginuser.following.length %>
                                        </h3>
                                        <h4>Following</h4>
                                    </div>
                                </a>
                            </div>
            </div>
            <div class="dets px-6 mt-5">
                <h3 class="text-lg mb-1">
                    <%= loginuser.fullname %>
                </h3>
                <p class="text-xs tracking-tight opacity-50">
                    <%= loginuser.bio ?? 'Add a bio' %>
                </p>
            </div>
            <div class="px-6 mt-5">
                <a class="px-3 py-2 bg-zinc-800 text-xs rounded-md" href="/edit">Edit Profile</a>
            </div>
        </div>

        <p class="px-6 hidden back cursor-pointer text-sm "> <span><i class="ri-arrow-left-line font-medium  mr -2"></i></span> Back to Previous</p>

        <div class="posts w-full pl-5 flex gap-2 py-2 mt-5 flex-wrap">
            <% if(loginuser.posts.length > 0){  %>

                <% loginuser.posts.forEach(function(elem){ %>

                    <a href="/myposts/open/<%= elem._id %>">
                        <div class="post  relative w-[30vw] h-[25vh]  mb-2 rounded-md bg-sky-100 overflow-hidden relative ">
                            <img class="w-full h-full object-cover" src="/images/uploads/<%= elem.image %>" alt="">

                            <div class="overlay absolute top-[0%] left-[0%] w-full h-full " style="background-color: rgba(0, 0, 0, 0.137);">

                                <% if(elem.pinned){ %>
                                    <p><i class="ri-pushpin-fill text-lg font-semibold absolute top-[3%] right-[7%] "></i></p>
                                    <% }   %>

                            </div>
                        </div>

                    </a>

                    <% })      %>

                        <%  }  else { %>
                            <p class="ml-5 font-light text-sm">No, post's yet.</p>
                            <% } %>
        </div>


    </div>


    <script>
        let upper = document.querySelector(".upper")
        let postbtn = document.querySelector(".postbtn");

        let back = document.querySelector(".back");


        postbtn.addEventListener("click", function(dets) {
            upper.style.display = "none";
            back.classList.replace("hidden", "flex");

        })

        back.addEventListener("click", function(e) {
            document.querySelector(".upper").style.display = "block";
            back.classList.replace("flex", "hidden");
        })
    </script>
    <% include ./partials/footer.ejs %>